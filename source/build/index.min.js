function _table(e){for(var t in window.ygarock=e)generateTable(t,e[t]);listenerTable()}function generateTable(e,t){for(var a=$("#"+e+" tbody"),n=a.find("tr").first().clone(),r=n.find(".text"),o=n.find(".badge"),l=$("<div></div>"),i=0;i<t.length;i++)n.find("td").append(r.text(t[i])),n.find("td").append(o),l.append(n.clone().attr("data-id",e+i));storage(),a.html(l.html()),listenerTable()}function listenerTable(){$(".badge").on("click",function(e){var t=$(e.target).closest("tr"),a=t.find(".text").text(),n=t.closest(".table").attr("id"),r=t.data("id");r=+r.replace(n,""),ygarock[n]&&confirm("Точно удалить "+a.trim()+"?")&&(ygarock[n].splice(r,1),generateTable(n,ygarock[n]))})}function storage(){localStorage.setItem("ygarock",JSON.stringify(ygarock))}$(function(){var n=null,r=null;function a(t){"use strict";var e=ygarock.green.filter(function(e){return t.val()===e}),a=ygarock.red.filter(function(e){return t.val()===e});n&&(n=!1,generateTable("green",ygarock.green)),r&&(r=!1,generateTable("red",ygarock.red)),e.length&&(n=!0,o("green",e)),a.length&&(r=!0,o("red",a))}function o(e,t){for(var a=$("#"+e+" tbody"),n=a.find("tr").first().clone(),r=n.find(".text"),o=n.find(".badge"),l=$("<div></div>"),i=0,c=-1;i<t.length;i++)c=ygarock[e].indexOf(t[i],c+1),n.find("td").append(r.text(ygarock[e][c])),n.find("td").append(o),l.append(n.clone().attr("data-id",e+c));a.html(l.html()),listenerTable()}$("#search").on("submit",function(e){e.preventDefault();var t=e.target;a($(t).find(".form-control"))}),$("#search .form-control").on("keyup",function(e){a($(e.target))})}),$(".input-group .btn").on("click",function(e){var t=$(e.target).closest(".input-group"),a=t.find(".form-control"),n=t.attr("id").replace("add_","");ygarock[n].push($(a).val()),$(a).val(""),generateTable(n,ygarock[n])}),$(".export").on("click",function(e){$("#importTextArea2").val(JSON.stringify(window.ygarock))}),$("#exampleModal2").on("hidden.bs.modal",function(e){$("#importTextArea2").val("")}),$("#saveImport").on("click",function(e){var t=$("#importTextArea").val();if(t)try{var a=JSON.parse(t);a.green&&a.green.length&&a.red&&a.red.length?(window.ygarock=a,generateTable("green",ygarock.green),generateTable("red",ygarock.red),$("#exampleModal").modal("hide")):alert("Ошибка.Мне нужен крепкий...JSON Statham")}catch(e){alert("Ошибка.Мне нужен крепкий...JSON Statham"),console.log(t,e)}}),$("#exampleModal").on("hidden.bs.modal",function(e){$("#importTextArea").val("")}),$(function(){$.ajax({url:"data.json"}).done(function(e){var t=localStorage.getItem("ygarock");t&&(e=JSON.parse(t)),_table(e)}).fail(function(){_table({green:["Пусто"],red:["Как в таблице моего рейтинга"]})})});