function _table(e){for(var t in window.ygarock=e)generateTable(t,e[t]);listenerTable()}function generateTable(e,t){for(var r=$("#"+e+" tbody"),n=r.find("tr").first().clone(),a=n.find(".text"),o=n.find(".badge"),i=$("<div></div>"),c=0;c<t.length;c++)n.find("td").append(a.text(t[c])),n.find("td").append(o),i.append(n.clone().attr("data-id",e+c));storage(),r.html(i.html()),listenerTable()}function listenerTable(){$(".badge").on("click",function(e){var t=$(e.target).closest("tr"),r=t.find(".text").text(),n=t.closest(".table").attr("id"),a=t.data("id");a=+a.replace(n,""),ygarock[n]&&confirm("Точно удалить "+r.trim()+"?")&&(ygarock[n].splice(a,1),generateTable(n,ygarock[n]))})}function storage(){localStorage.setItem("ygarock",JSON.stringify(ygarock))}$(function(){var n=null,a=null;function r(t){"use strict";var e=ygarock.green.filter(function(e){return t.val()===e}),r=ygarock.red.filter(function(e){return t.val()===e});n&&(n=!1,generateTable("green",ygarock.green)),a&&(a=!1,generateTable("red",ygarock.red)),e.length&&(n=!0,o("green",e)),r.length&&(a=!0,o("red",r))}function o(e,t){for(var r=$("#"+e+" tbody"),n=r.find("tr").first().clone(),a=n.find(".text"),o=n.find(".badge"),i=$("<div></div>"),c=0,l=-1;c<t.length;c++)l=ygarock[e].indexOf(t[c],l+1),n.find("td").append(a.text(ygarock[e][l])),n.find("td").append(o),i.append(n.clone().attr("data-id",e+l));r.html(i.html()),listenerTable()}$("#search").on("submit",function(e){e.preventDefault();var t=e.target;r($(t).find(".form-control"))}),$("#search .form-control").on("keyup",function(e){r($(e.target))})}),$(".input-group .btn").on("click",function(e){var t=$(e.target).closest(".input-group"),r=t.find(".form-control"),n=t.attr("id").replace("add_","");ygarock[n].push($(r).val()),$(r).val(""),generateTable(n,ygarock[n])}),$(".export").on("click",function(e){prompt("Используй Ctrl + C,а затем Enter или Ok",JSON.stringify(ygarock))}),$(".import").on("click",function(e){var t=prompt("Используй Ctrl + V,а затем Enter или Ok");if(t)try{window.ygarock=JSON.parse(t),generateTable("green",ygarock.green),generateTable("red",ygarock.red)}catch(e){alert("Ошибка.Мне нужен крепкий...JSON Statham"),console.log(t,e)}}),$(function(){$.ajax({url:"data.json"}).done(function(e){var t=localStorage.getItem("ygarock");t&&(e=JSON.parse(t)),_table(e)}).fail(function(){_table({green:["Пусто"],red:["Как в таблице моего рейтинга"]})})});